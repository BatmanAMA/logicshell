stages:
  - lint
  - test
  - release
variables:
  GIT_SSL_NO_VERIFY: "true"
lint:
  stage: lint
  tags:
    - pwsh
  script:
    - $results = Invoke-ScriptAnalyzer . -Recurse; $results; exit $results.count
test:
  stage: test
  tags: 
   - pwsh
  script:
   - Invoke-Pester -EnableExit -CodeCoverage .\functions\*.ps1
  except:
    - master
release:
  stage: release
  tags: 
   - pwsh
  script:
   - Invoke-PSDeploy
  only:
    - master